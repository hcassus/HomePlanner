machine:
  java:
    version: openjdk8
    
  services:
    - postgresql

database:
  override:
    - createdb hrp

deployment:
  staging:
    branch: master
    heroku:
      appname: nameless-brushlands-59783

test:
  override:
    - case $CIRCLE_NODE_INDEX in 0) mvn -B test cobertura:cobertura -Dexcludes="**/api/*,**/ui/tests/*" ;; 1) mvn -B test -Dtest="**/api/*,**/ui/tests/*" ;; esac:
        parallel: true
  post:
    - mkdir -p $CIRCLE_TEST_REPORTS/junit/
    - find . -type f -regex ".*/target/surefire-reports/.*xml" -exec cp {} $CIRCLE_TEST_REPORTS/junit/ \;
    - bash <(curl -s https://codecov.io/bash)
